<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ejercicio 9</title>
</head>

<body>
    <!DOCTYPE html>
    <html lang="es">

    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Ejercicio 7</title>
        <script>
            function iniciar() {
                document.getElementById("comprueba").addEventListener("click", compruebaFecha);
            }

            function compruebaFecha() {
                let fecha = document.getElementById("fecha").value;

                let formato = /^([1-9]|[12][0-9]|3[01])\/(0[1-9]|1[0-2])\/(\d{4})$/;

                let conf = fecha.match(formato);

                if (conf != null) {
                    let correcta = fechaCorrecta(fecha);
                    if (!correcta) {
                        document.getElementById("fecha").style = "background: red;";
                        alert("Fecha incorrecta. Asegura que tu fecha sea real");
                    } else {
                        document.getElementById("fecha").style = "background: none;";
                        let fechaf = fecha.split("/");
                        let dia = fechaf[0];
                        let mes = fechaf[1];
                        let anio = fechaf[2];
                        document.body.innerHTML += escribirFecha(dia, mes, anio);
                    }
                } else {
                    document.getElementById("fecha").style = "background: red;";
                    alert("Fecha incorrecta. Revisa que el formato sea dd/mm/yyyy");
                }
            }

            function fechaCorrecta(fecha) {
                let fechaf = fecha.split("/");

                let dia = parseInt(fechaf[0]);
                let mes = parseInt(fechaf[1]);
                let anio = parseInt(fechaf[2]);

                if (dia < 1) {
                    return false;
                }

                switch (mes) {
                    case 1:
                    case 3:
                    case 5:
                    case 7:
                    case 8:
                    case 10:
                    case 12:
                        if (dia > 31)
                            return false;
                        break;
                    case 4:
                    case 6:
                    case 9:
                    case 11:
                        if (dia > 30)
                            return false;
                        break;
                    case 2:
                        if (anio % 4 == 0 && !(anio % 100 == 0 && anio % 400 != 0)) {
                            if (dia > 29)
                                return false;
                        } else {
                            if (dia > 28)
                                return false;
                        }
                        break;
                    default:
                        return false;
                }
                return true;

            }

            function escribirFecha(d, m, y) {
                let fecha = new Date(d, m - 1, y); //Hacemos una fecha con los datos que nos pasan

                switch (fecha.getDay()) { //getDay nos devuelve un entero del 0 al 6, siendo 0 domingo y 6 sabado
                    case 0:
                        return "Domingo";
                    case 1:
                        return "Lunes";
                    case 2:
                        return "Martes";
                    case 3:
                        return "Miercoles";
                    case 4:
                        return "Jueves";
                    case 5:
                        return "Viernes";
                    case 6:
                        return "Sabado";
                }
            }
        </script>
    </head>

    <body onload="iniciar()">
        <label for="fecha">Escribe una fecha</label>
        <br>
        <input type="text" id="fecha">
        <br>
        <button id="comprueba">Comprobar si la fecha es correcta</button>
    </body>

    </html>
</body>

</html>